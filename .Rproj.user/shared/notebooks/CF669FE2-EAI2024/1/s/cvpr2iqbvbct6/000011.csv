"0","# create geometric mean function"
"0","gmean <- function(x) exp(mean(log(x)))"
"0",""
"0","#calculate EAI for each biome"
"0","biome_eai <- eai_vegw %>% "
"0","  select(c(BIOME,pnat_1990, pnat_2014, pnat_2018, pnat_2020, pnat_2022)) %>%"
"0","  group_by(BIOME) %>%   "
"0","  summarise(across(everything(), gmean),.groups ='drop')"
"0",""
"0","# calculate total EAI add make it bindable to biome table  "
"0","tot_eai <- eai_vegw %>% "
"0","  select(c(pnat_1990, pnat_2014, pnat_2018, pnat_2020, pnat_2022)) %>%"
"0","  summarise(across(everything(), gmean))%>% "
"0","  mutate(BIOME = ""Total"") %>%"
"0","  relocate(BIOME, .before = pnat_1990)"
"0",""
"0","# combine the tables make longer and make the dates numeric"
"0","res_eai_long <- list(biome_eai, tot_eai) %>% "
"0","  bind_rows()%>%  "
"0","   pivot_longer(!BIOME,names_to = ""YEAR"", values_to = ""EAI"") %>%"
"0","   mutate(YEAR = ifelse(YEAR==""pnat_1990"", 1990,YEAR), YEAR ="
"0","       ifelse(YEAR==""pnat_2014"", 2014,YEAR), YEAR = ifelse(YEAR==""pnat_2018"", 2018,YEAR), YEAR = ifelse(YEAR==""pnat_2020"", 2020,YEAR), YEAR = ifelse(YEAR==""pnat_2022"", 2022,YEAR))"
"0","res_eai_long$YEAR <- as.numeric(res_eai_long$YEAR)"
"0",""
"0","#output"
"0","write.csv(res_eai_long, file = ""results_df_EAI.csv"", row.names = FALSE)"
"0",""
